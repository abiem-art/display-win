<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Display Dashboard - Fixed Header</title>
    <style>
        body { margin: 0; padding: 0; background: #222; overflow: hidden; font-family: 'Arial Narrow', sans-serif; }
        
        /* HEADER UTAMA (NAMA SHEET) */
        #top-bar {
            position: fixed; top: 0; width: 100%; height: 40px;
            background: #000; color: yellow; line-height: 40px;
            text-align: center; font-weight: bold; font-size: 1.2rem; z-index: 110;
        }

        /* HEADER KOLOM (Daftar Tulisan yang Anda Berikan) */
        #column-header {
            position: fixed; top: 40px; width: 100%; height: 40px;
            background: #444; color: white; z-index: 100;
            display: flex; align-items: center; justify-content: space-around;
            padding: 0 5px; box-sizing: border-box;
            font-size: 0.75rem; /* Ukuran font agak kecil agar muat banyak kolom */
            border-bottom: 2px solid #000;
            white-space: nowrap;
        }

        /* Styling teks per kolom agar rapi */
        .col-item { padding: 0 5px; border-right: 1px solid #666; font-weight: bold; }
        .col-item:last-child { border-right: none; }

        /* AREA KONTEN GOOGLE SHEETS */
        #frame-container {
            position: absolute; top: 80px; width: 100%; bottom: 0;
            overflow: hidden;
        }

        #sheet-frame {
            position: absolute; top: 0; width: 100%; height: 5000px; 
            border: none; transition: opacity 0.5s ease; background: white;
        }
    </style>
</head>
<body>

    <div id="top-bar">LOADING DATA...</div>

    <div id="column-header">
        <div class="col-item">NAME RESULT</div>
        <div class="col-item">NIK</div>
        <div class="col-item">CPY/DEPT</div>
        <div class="col-item">MCU</div>
        <div class="col-item">BSS</div>
        <div class="col-item">OS</div>
        <div class="col-item">TKPK1</div>
        <div class="col-item">TKPK2</div>
        <div class="col-item">TKPK3</div>
        <div class="col-item">TBOSIET</div>
        <div class="col-item">OPITO</div>
        <div class="col-item">SBTC</div>
        <div class="col-item">IFP_ONWJ</div>
        <div class="col-item">HSSE.PAS.OSES</div>
        <div class="col-item">MC_EP</div>
        <div class="col-item">CCNA</div>
        <div class="col-item">SKCK</div>
        <div class="col-item">SPV</div>
        <div class="col-item">WIN</div>
    </div>
    
    <div id="frame-container">
        <iframe id="sheet-frame" src=""></iframe>
    </div>

<script>
    const baseURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRC1JkB8aVBnGb8F3mphAGkbyBhn7tjDOlFxnqvJ9aXRkp6leS0Ogra9MCukRLf9QXbziwzJF7TWKtS/pubhtml";

    const sheets = [
        { name: "PVIEW 1P", gid: "0" }, 
        { name: "PVIEW 2P", gid: "2026504873" }
    ];

    let currentSheet = 0;
    let scrollPos = 0; 
    const speed = 1.2; // Kecepatan jalan

    // --- PENGATURAN BARIS 70 ---
    // Sesuaikan angka 1900 ini sampai pas berhenti di baris 70 monitor Anda
    const maxScroll = 1900; 
    
    let scrollTimer;
    const frame = document.getElementById('sheet-frame');
    const topBar = document.getElementById('top-bar');

    function loadSheet(index) {
        clearInterval(scrollTimer);
        frame.style.opacity = "0"; 
        scrollPos = 0; 
        frame.style.top = "0px";
        
        const finalURL = `${baseURL}?gid=${sheets[index].gid}&single=true&widget=false&headers=false&chrome=false`;
        frame.src = finalURL;
        topBar.innerText = "MONITORING: " + sheets[index].name;

        frame.onload = () => {
            frame.style.opacity = "1";
            setTimeout(() => {
                scrollTimer = setInterval(autoScroll, 30);
            }, 3000); // Diam di atas 3 detik agar orang bisa baca baris awal
        };
    }

    function autoScroll() {
        scrollPos -= speed;
        frame.style.top = scrollPos + "px";

        // Cek jika sudah mencapai batas bawah (Baris 70)
        if (Math.abs(scrollPos) >= maxScroll) {
            clearInterval(scrollTimer);
            
            // Diam di bawah 2 detik sebelum ganti halaman
            setTimeout(() => {
                currentSheet = (currentSheet + 1) % sheets.length;
                loadSheet(currentSheet);
            }, 2000);
        }
    }

    // Jalankan pertama kali
    loadSheet(currentSheet);
</script>
</body>
</html>
