<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Display Dashboard - Auto Header</title>
    <style>
        body { margin: 0; padding: 0; background: #222; overflow: hidden; font-family: 'Arial Narrow', Arial, sans-serif; }
        
        #top-bar {
            position: fixed; top: 0; width: 100%; height: 45px;
            background: #000; color: #00FF00; line-height: 45px;
            text-align: center; font-weight: bold; font-size: 1.4rem; z-index: 110;
            border-bottom: 1px solid #333;
        }

        /* HEADER KOLOM YANG DINAMIS */
        #column-header {
            position: fixed; top: 45px; width: 100%; min-height: 40px;
            background: #444; color: white; z-index: 100;
            display: flex; align-items: center; justify-content: flex-start;
            padding: 5px 10px; box-sizing: border-box;
            font-size: 0.7rem; border-bottom: 2px solid #000;
            word-break: break-all; line-height: 1.2;
        }

        #frame-container {
            position: absolute; top: 85px; width: 100%; bottom: 0;
            overflow: hidden; background: white;
        }

        #sheet-frame {
            position: absolute; top: 0; width: 100%; 
            height: 5000px; /* Pastikan tinggi ini cukup besar agar data tidak terpotong */
            border: none; transition: opacity 0.8s ease;
        }
    </style>
</head>
<body>

    <div id="top-bar">LOADING...</div>
    <div id="column-header" id="col-content">
        </div>
    
    <div id="frame-container">
        <iframe id="sheet-frame" src=""></iframe>
    </div>

<script>
    const baseURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRC1JkB8aVBnGb8F3mphAGkbyBhn7tjDOlFxnqvJ9aXRkp6leS0Ogra9MCukRLf9QXbziwzJF7TWKtS/pubhtml";

    // DAFTAR SHEET DAN HEADERNYA MASING-MASING
    const sheets = [
        { 
            name: "PVIEW 1P", 
            gid: "0",
            headerText: "NAME RESULT | NIK | CPY/DEPT | MCU | BSS | OS | TKPK1 | TKPK2 | TKPK3 | TBOSIET | OPITO | SBTC | IFP_ONWJ | HSSE.PAS.OSES | MC_EP | CCNA | SKCK | SPV | WIN"
        }, 
        { 
            name: "PVIEW 2P", 
            gid: "2026504873",
            headerText: "NAME | CPY/DEPT | LOC | 4-Jan | 5 6 7 8 9-Jan | 10 11 12 13 14 15-Jan | 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 | 1 2 3 4-Feb | 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26-Feb"
        }
    ];

    let currentSheet = 0;
    let scrollPos = 0; 
    const speed = 1.2; 
    const maxScroll = 2000; // Sesuaikan sampai baris 70
    let scrollTimer;

    const frame = document.getElementById('sheet-frame');
    const topBar = document.getElementById('top-bar');
    const colHeader = document.getElementById('column-header');

    function loadSheet(index) {
        clearInterval(scrollTimer);
        frame.style.opacity = "0"; 
        scrollPos = 0; 
        frame.style.top = "0px";
        
        // Load URL
        const finalURL = `${baseURL}?gid=${sheets[index].gid}&single=true&widget=false&headers=false&chrome=false`;
        frame.src = finalURL;
        
        // Update Judul Atas dan Teks Header Kolom
        topBar.innerText = "MONITORING: " + sheets[index].name;
        colHeader.innerText = sheets[index].headerText;

        frame.onload = () => {
            frame.style.opacity = "1";
            // Jeda sebelum scroll
            setTimeout(() => {
                scrollTimer = setInterval(autoScroll, 30);
            }, 3000);
        };
    }

    function autoScroll() {
        scrollPos -= speed;
        frame.style.top = scrollPos + "px";

        if (Math.abs(scrollPos) >= maxScroll) {
            clearInterval(scrollTimer);
            setTimeout(() => {
                currentSheet = (currentSheet + 1) % sheets.length;
                loadSheet(currentSheet);
            }, 2000);
        }
    }

    loadSheet(currentSheet);
</script>
</body>
</html>
